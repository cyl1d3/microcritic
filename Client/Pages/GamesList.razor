@page "/gameslist"
@inject HttpClient Http
@using microcritic.Shared.ViewModels

<h3>Games List</h3>

<div class="w-100 h-100 d-flex justify-content-center mt-5">
	<table class="table table-hover w-75">
		<thead>
		</thead>
		<tbody>
			@foreach (var game in _games ?? Array.Empty<Game>())
			{
				<tr>
					<td><a href="/gamedetails/@game.Id">@game.Name</a></td>
					<td>@game.Developer</td>
					<td><ScoreDisplay Score="game.Score" ReviewCount="game.ReviewCount" /></td>
				</tr>
			}
		</tbody>
	</table>
</div>

@code {

	private Game[] _games;
	private int _page = 0;

	protected override void OnInitialized()
	{
		base.OnInitialized();
		Refresh();
	}

	private async Task Refresh()
	{
		_games = await Http.GetFromJsonAsync<Game[]>($"/api/Games/List/{_page}");
		StateHasChanged();
	}

}
